<!-- Code from d3-graph-gallery.com -->
<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js and the geo projection plugin -->
<script src="http://d3js.org/d3.v4.js"></script>
<script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

<!-- Load Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

<!-- Create an element where the map will take place -->
<div id="mapid"></div>

<style>
#mapid { height: 600px; }
</style>

<script type='text/javascript' src='data/Hotel_data_test.json'></script>

<script>
// mapid is the id of the div where the map will appear
var map = L.map( 'mapid', {
  center: [46.0, 5.0],
  minZoom: 2,
  zoom: 5
})

// Add a tile to the map = a background. Comes from OpenStreetmap
L.tileLayer(
    'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a>',
    maxZoom: 22,
    }).addTo(map);

// Add a svg layer to the map
L.svg().addTo(map);


// Select the svg area and add circles:
d3.select("#mapid")
  .select("svg")
  .selectAll("myCircles")
  .data(Hotel_data_test)
  .enter()
  .append("circle")
    .attr("cx", function(d){  return map.latLngToLayerPoint(d.Coordinates).x })
    .attr("cy", function(d){  return map.latLngToLayerPoint(d.Coordinates).y })
    .attr("r", function(d){  return Math.max(d.Total_Number_of_Reviews/500,5)})
    .style("fill", "red")
    .attr("stroke", "red")
    .attr("stroke-width", 2)
    .attr("fill-opacity", .4)
    .on('mouseover', function(d){
      console.log("s")
})

// Function that update circle position if something change
function update() {
  d3.selectAll("circle")
    .attr("cx", function(d){ console.log("as");return map.latLngToLayerPoint(d.Coordinates).x })
    .attr("cy", function(d){ return map.latLngToLayerPoint(d.Coordinates).y })
}


// If the user change the map (zoom or drag), I update circle position:
map.on("moveend", update)


</script>